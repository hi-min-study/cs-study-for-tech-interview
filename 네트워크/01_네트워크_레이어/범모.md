- 네트워크 레이어
    - OSI 7계층
    - TCP/IP 4계층
    - IP
        - IPv4 vs IPv6
        - subnet
        - CIDR
        

### OSI 7계층이란?

- 네트워크에서 통신이 일어나는 과정을 7단계로 나눈 것

### OSI 7계층의 구성요소와 그 구성요소의 역할/통신 단위/통신 장비를 말해보시오.

- 1. 물리 계층 (Physical Layer)
    - 역할
        - 시스템 간의 물리적 연결을 하고, 전기 신호의 변환 및 제어 역할을 담당한다. 데이터(디지털 신호)를 **전기신호/아날로그 신호**로 바꾸어 전송하고, 전기신호를 받아 디지털 신호로 변환하는 일을 한다.
    - 통신 단위
        - 비트(0 or 1)
    - 통신 장비(수단)
        - 랜카드
            - UTP 케이블이 꽂혀있는 곳
            - 디지털 신호를 전기 신호로 만들어주는 주체
        - 랜케이블
            - TP(Twisted Pair)
                - 랜선이라고도 불리운다.
                - 총 8가닥의 선으로 구성되며 두개의 선을 서로 꼬아놓는다
                - 선을 꼬은 이유는 자기장 간섭을 최소화하여 성능(속도와 거리)을 향상시키기 때문.
                - UTP 케이블 (Unshield Twisted Pair)
                    - 내부에 감싸져 있는 것이 없음
                    - 단가가 저렴하고 만들기 쉽다. → 일반적으로 많이 사용된다.
                    - 다만 실드 처리가 돼있지 않으므로 노이즈에 약하다 → 소규모 네트워크망을 구축할 때 주로 사용 (가정/사무용)
                    - 참고
                        - 우리가 일반적으로 쓰는 UTP케이블의 종류는 카테고리 5(Cat5)이다.
                - STP 케이블 (Shielded Twisted Pair)
                    - 네 쌍의 페어를 각각 알루미늄 실드로 감싼다.
                        - 각각 실드처리가 돼있기 때문에 노이즈 방지에 탁월
                - FTP 케이블 (Foiled Tiwsted Pair)
                    - 네 쌍의 페어를 한꺼번에 알루미늄 실드로 감싼다
                    - UTP에 비해 잡음에 강하고 절연 특성이 강하다
                    - 혼선이 심한 환경, 공장 등 배선용으로 사용 가능
            - 동축
                - 선 중앙에 심선이 있으며 그 주위를 절연물과 외부 도체로 감싸고 있다.
                - 전화 또는 회선망 등 광범위하게 사용된다.
                - 아날로그/디지털 신호 모두 전송 가능
            - 광(Fiber)
                - 레이저에 데이터를 실을 수 있는 기술을 사용하여 다른 케이블 보다 훨씬 빠른 속도로 데이터를 전달할 수 있다.
        - 허브
            - LAN을 구성할 때 포트에 연결된 PC들끼리 통신이 가능하게 한다
            - **브로드캐스팅** 방식으로 하나의 PC가 데이터를 전송하면, 포트에 연결된 다른 모든 PC가 해당 데이터를 받는다.
        - 리피터
            - 신호를 수신하여 신호를 증폭시킨 이후 다음 구간으로 재전송
            - 신호 감쇠를 보상하기 때문에, 여러대의 리피터를 사용하여 신호를 먼 거리까지 전달하는 것이 가능하다.
            - 다만 요즘 네트워크 장비에는 리피터 기능이 탑재돼 있어 쓰지 않는다.
    - 특징
        - 신호는 두가지 종류로 나뉜다. 아날로그 신호와 디지털 신호.
        - 아날로그  : 0~1사이의 어딘가.
        - 디지털 신호 : 0 혹은 1 둘중 하나.
        - 단순히 데이터를 전달만 하기 때문에 데이터 검증, 에러 확인 등은 이루어지지 않음 → 신뢰성이 떨어진다.
- 2.데이터 링크 계층 (DataLink Layer)
    - 역할
        - 인접한 네트워크 기기간의 데이터 전송을 담당하며, 오류 검출 및 제어 기능을 수행.
        - 회선제어/흐름제어/오류제어를 담당한다. (자세한 내용은 다음 주제에서 다룬다.)
        - Framing
            - 네트워크 계층에서 받아온 패킷에, 헤더와 트레일러를 추가한다. (캡슐화)
            - 헤더 : 목적지, 출발지 주소 포함
            - 트레일러 : 비트의 에러 감지
    - 통신 단위
        - 프레임
            
            ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/f161c15f-c5f0-4683-9793-c7551a62792f/7e67f9c9-4678-4aa3-b380-85f99ea5b255/Untitled.png)
            
        - 출처 : https://chanz-nap.tistory.com/33
    - 통신 장비
        - 브릿지
            - 네트워크 세그먼트를 서로 연결해 주는 장치
        - 스위치
            - MAC address table에서 MAC 주소를 참고하여 1:1로 목적지 포트로 데이터를 전송한다.
    - 프로토콜
        - 이더넷
            - CSMA/CD(Carrier Sense Multiple Access with Collision Detection)
                - 반이중 통신 방식
    - 등장배경
        - 물리계층의 통신장비만 이용해서는 연결하려는 PC의 개수가 늘어날 수록 케이블 연결이 늘어나므로, 여러대의 PC간 통신을 쉽게 하기 위해 등장.
    - 특징
        - 2개의 부 계층으로 구성된다.
            - MAC(Media Access Control)
                - 각 장치에 고유한 주소 할당, 매체간 연결 방식을 제어하고(장비간의 통신 순서 및 어떤 데이터 신호로 전달할지) 1계층과 연결돼있다.
            - LLC(Logical Link Control)
                - 네트워크 계층에서 전달된 패킷을 프레임으로 만든다.
                - 에러제어, 필요시(토큰 패싱 방식의 경우) 흐름제어까지도 담당한다.
- 3.네트워크 계층 (Network Layer)
    - 역할
        - 실제 네트워크간 포워딩, 라우팅을 담당.
        - SDN이 **라우팅**을 통해 경로를 설정하고, 각 라우터에서 **포워딩**을 통해 패킷이 옮겨진다.
    - 통신 단위
        - 패킷
    - 통신 장비
        - 라우터
            - input port, output port, Switching Fabric, Routing Processor로 구성.
    - 프로토콜
        - IP 프로토콜
            - 비연결성이며, 패킷 기반의 통신을 지원. 이는 각각의 패킷이 독립적으로 전송되며, 패킷이 도달하는 순서가 보장되지 않는다는 의미. 이러한 특징은 유연성을 제공하며, 손상된 패킷이나 패킷 손실에 대한 복구 메커니즘은 상위 계층의 프로토콜에서 처리된다.
        - ARP
- 4.전송 계층 (Transport Layer)
    - 등장배경
        - 라우팅 정보가 잘못될 수 있고
        - 많은 라우터를 경유하는 도중에 라우터에 문제가 생기거나
        - 패킷이 손상되거나 유실되더라도 하위 계층에서 할 수 있는것이 없다.
    - 역할
        - 데이터가 제대로 도착했는지 확인한다.
        - 흐름제어
    - 통신 단위
        - Segment(TCP) / Datagram(UDP)
    - 프로토콜
        - TCP
        - UDP
        - TCP는 연결 지향형 프로토콜로 패킷에 하나의 오류라도 있으면 재전송을 위해 에러를 복구하는 반면, UDP는 패킷을 중간에 잃거나 오류가 발생해도 이에 대처하지 않고 계속해서 데이터를 전송하는 TCP에 비해 간단한 구조를 가지는 프로토콜이란 차이가 있다.
        - (자세한건 다음 주제에서)
- 5.세션 계층 (Session Layer)
    - 역할
        - 응용 프로그램 간의 대화를 유지하기 위한 구조를 제공
        - 통신 중 연결이 끊어지지 않도록 유지시켜주는 역할을 수행하기 위해 TCP/IP 세션 연결의 설정과 해제, 세션 메세지 전송 등의 기능을 수행한다.
        - 양 끝단의 응용 프로세스가 통신을 관리하기 위한 방법으로써 동시 송수신(duplex), 전이중, 반이중 방식을 제공한다.
    - 프로토콜
        - SSH, TLS
    - 통신 단위
        - message
- 6.표현 계층 (Presentation Layer)
    - 역할
        - 애플리케이션이 다루는 정보를 통신에 알맞은 형태로 만들거나, 하위 계층에서 온 데이터를 사용자가 이해할 수 있는 형태로 만드는 역할을 담당하는 계층.
        - 압축, 압축 해제, 암호화, 복호화 등을 수행한다.
    - 프로토콜
        - ASCII/MPEG/JPEG/MIDI/SSL
    - 통신 단위
        - message
- 7.응용 계층 (Application Layer)
    - 역할
        - 클라이언트의 요청을 전달하기 위해 서버가 이해할 수 있는 메시지(데이터)로 변환하고 전송 계층에 전달하는 역할을 수행.
        - 사용자와 상호작용하기 위한 다양한 서비스/응용 프로그램 제공(이메일, 파일전송, 동영상 스트리밍)
        - 어플리케이션간 통신 지원
    - 프로토콜
        - HTTP/DNS/FTP/SMTP/POP3
    - 통신 단위
        - message

### OSI 7계층을 나눈 이유를 서술하시오.

- 통신이 일어나는 과정을 7단계로 나누어서 파악할 수 있기 때문에, 흐름을 한 눈에 알아보기 쉽고, 사람들이 이해하기 쉽다.
- 또한 특정 계층에서 문제가 생겼다면 **다른 단계의 장비/소프트웨어를 건드리지 않고도** 문제가 생긴 계층만 고칠 수 있어서 유용하다.

### 이더넷 프로토콜에 대해 설명해 주시고, 장단점을 간단히 말해주세요.

- LAN을 위해 개발된 유선 네트워크 통신망 기술. 프레임과 MAC주소를 통하여 통신한다.
- CSMA/CD방식을 통해 통신한다.
- 장점
    - 적은 용량의 데이터를 전송할 경우 성능이 우수하다.
    - 설치 비용이 저렴하고 관리가 쉽다.
    - 네트워크 구조가 단순하다.
- 단점
    - 네트워크 사용 시에 신호 때문에 충돌이 발생한다.
    - 충돌이 발생하면 네트워크에서 지연이 발생한다.
    - 시스템의 부하가 증가하면 충돌도 계속적으로 증가한다.

### TCP/IP 4계층에 대해 설명해 주세요

- 1. 네트워크 액세스(링크) 계층
    - 데이터 단위 : Frame
    - 역할
        - 물리적인 데이터의 전송을 담당하는 계층으로, 여기서는 인터넷 계층과 달리 같은 네트워크 안에서 데이터가 전송된다. 노드 간의 신뢰성 있는 데이터 전송을 담당하며, 논리적인 주소가 아닌 물리적인 주소인 MAC을 참조해 장비간 전송을 하고, 기본적인 에러 검출과 패킷의 Frame화를 담당한다.
    - 프로토콜
        - 이더넷
- 2.인터넷(네트워크) 계층
    - 데이터 단위 : Packet/Datagram
    - 역할
        - 네트워크 상에서 데이터의 전송을 담당하는 계층으로 서로 다른 네트워크 간의 통신을 가능하게 하는 역할을 수행한다.
        - 단말을 구분하기 위해 논리적인 주소로 IP 주소를 할당하게 되고 이 **IP 주소**로 네트워크 상의 컴퓨터를 식별하여 주소를 지정할 수 있도록 해준다.
    - 프로토콜
        - IP
- 3.전송 계층
    - 데이터 단위 : Segment
    - 역할
        - 통신 노드 간의 데이터 전송 및 흐름에 있어 신뢰성을 보장한다. 이는 다시 말해 데이터를 적절한 어플리케이션에 제대로 전달되도록 배분함을 의미하며 다른 말로 End-to-End의 신뢰성을 확보 한다고도 표현할 수 있다.
    - 프로토콜
        - TCP
        - UDP
- 4.응용 계층
    - 데이터 단위 : Data/Message
    - 역할
        - 사용자와 가장 가까운 계층으로 사용자-소프트웨어 간 소통을 담당하는 계층이다. 웹 프로그래밍을 하면서 흔히 접하는 여러 서버나 클라이언트 관련 응용 프로그램들이 동작하는 계층이다. 주로 **응용 프로그램(Application)들끼리 데이터를 교환**하기 위한 계층이다.
        - 기존 OSI 7계층의 응용+표현+세션계층을 합친 계층이다.
    - 프로토콜
        - HTTP/DNS/FTP/SMTP/POP3

### CSMA/CD 프로토콜에 대해 설명해 주세요.

CS, MA, CD 3가지로 구성된 프로토콜입니다.

CS(Carrier Sense) : 이더넷 환경에서 통신을 하고 싶은 PC나 서버는 먼저 네트워크 상에 통신이 일어나는지 확인을 한다

MA(Multiple Access) : 여러 디바이스가 동시에 네트워크에 접근할 수 있다.

CD(Collision Detection) : 데이터 전송 중에 충돌이 감지되면 충돌을 처리하는 메커니즘

다음과 같은 순서로 동작합니다.

1. 전송을 원하는 호스트는 네트워크에 캐리어를 감지해 전송이 가능한지 검사한다. ex) A에서 D로 데이터 프레임을 전송
2. 전송이 가능할 경우 A에서 B, C, D로 브로드캐스트를 하여 D를 찾아낸다. (여기서 D는 유니캐스트로 응답한다)
3. 그 후 전송을 한다.
4. 만약 전송중 충돌이 감지된다면, 전송을 중지하고 Jam Signal을 모든 호스트에게 전송한 이후, 랜덤 시간동안 기다렸다가 다시 전송을 시작한다.

### 전이중 통신과 반이중 통신에 대해 설명해 주세요.

**전이중 통신 방식**(full-duplex communication)

> 전화 회선과 같이 **송신과 수신이 양쪽에서 동시에** 이루어지는 양방향 통신이다.
서로 다른 회선이나 주파수를 이용하여 데이터 신호가 충돌되는 상황을 방지한다. 
스위치 허브를 사용하면 랜 카드와 허브 간의 동시 송수신이 가능해진다.
> 

**반이중 통신 방식** (half-duplex communication)

> 전이중 통신 방식과 달리, 회선 하나로 송신과 수신을 **번갈아가면서** 통신하는 방식이다.
> 

전이중 통신 방식은 데이터를 동시에 전송해도 충돌이 발생하지 않지만, 반이중 통신 방식은 데이터를 동시에 전송하면 충돌이 발생한다.

### HOL Blocking에 대해 설명해 주세요.

Head Of Line Blocking. 

queue의 head(front) packet이 나가지 못하여 뒤의 패킷이 포워딩되지 못하는 상태.

### ARP에 대해 설명해 주세요.

- 주소 결정 프로토콜(Address Resolution Protocol)입니다.
- 해당 IP를 그 IP주소에 맞는 물리적인 주소 즉, MAC주소를 가지고 오는 프로토콜입니다.
- 역순 주소 결정 프로토콜 (Reverse Address Resolution Protocol)은 ARP와 반대로 해당 MAC주소에 맞는 IP값을  알아오는 프로토콜 입니다.

### 간단한 ARP 프로토콜 흐름에 대해 설명해주세요.

1. 송신자는 목적지 물리주소가 필요하므로, 물리주소 요청을 위한 ARP요청 패킷을 브로드캐스트로
전송.(브로드캐스트를 하는 이유는 목적지의 물리주소를 모르므로 모두에게 요청함.)(요청 패킷에는 수신자가 수신자 주소를 응답할 때 필요한 송신자 주소가 포함)
2. 모든 호스트와 라우터는 송신자가 보낸 ARP 요청 패킷을 수신함
3. 해당되는 수신자만 자신의 논리주소(IP)와 물리주소(MAC)를 넣어 응답 패킷을 유니캐스트로 전송.

### OSI 7계층과 TCP/IP 4계층의 차이를 설명해보시오.

OSI 7계층은 통신 자체를 어떠한 방식으로 할지에 대한 표준을 정립한 것이고,

TCP/IP 4계층은 실질적인 통신 자체에서 사용되는 것에 차이가 있습니다.

### **네트워크에서 데이터가 전송되는 과정을 간단히 설명해 주세요.**

1. 예를 들어 이메일을 보낸다고 가정하겠습니다.
2. 사용자가 이메일을 보내면, 응용계층에서 헤더를 붙여 표현 계층으로 내려줍니다.
3. 표현계층에서도 해당 데이터의 앞에 헤더를 붙이는 식으로 하향식으로 캡슐화를 진행하여 최종적으로 물리계층까지 데이터를 내려준 이후,
4. 물리계층에서 목적지에 데이터를 전기 신호로 보내줍니다.
5. 이후 목적지에서 전기 신호/광신호를 수신하면, 디지털 신호로 복원하여 2계층으로 올려줍니다.
6. 데이터 링크 계층에서 자신의 MAC주소와 실제 목적지 주소(DA)가 같은지 검사한다. 맞으면 3계층으로 올려줍니다.
7. 네트워크 계층에서는 데이터 링크 계층으로 부터 받은 IP주소를 확인해서 맞다면 4계층으로 올려줍니다.
8. 전송계층에서는 쪼개서 보내진 패킷들을 하나의 데이터 덩어리로 재조립하고, 만약 TCP 프로토콜을 사용하고, 데이터를 정상적으로 받았다면 송신자에게 ACK을 보내고 데이터 덩어리를 세션계층으로 올려줍니다.
9. 이후 세션계층은 보내는 쪽과 받는 쪽을 연결하고 안정적으로 유지되도록 관리하며, 표현계층에서 필요시 데이터 압축 해제/복호화등을 진행하여 최종적으로 응용계층에서 필요한 데이터를 사용합니다.

### Ip주소에서의 클래스에 대해 설명해 주세요.

- 하나의 IP주소에서 네트워크 영역과 호스트 영역을 나누는 방법이자, 약속**.**
- (꼬리질문) 클래스는 왜 쓰나요?
    - 네트워크 영역과 호스트 영역을 나누어 호스트 IP의 갯수를 조절함으로써 네트워크의 크기를 나누기 위함.

### IPv4와 IPv6의 차이점을 설명해 주세요.

|  | IPv4 | IPv6 |
| --- | --- | --- |
| 주소 길이 | 32비트 | 128비트 |
| 주소 할당 방식 | 클래스 단위 비순차 할당 | 네트워크 규모, 단말기수에 따라 순차할당 |
| 브로드캐스트 주소 | 있음 | 없음 |
| 헤더 크기 | 가변 | 불변 |
| 헤더 필드 |  | IPv4대비 줄어듦 (대표적으로 헤더 크기 필드) |

### 서브넷의 탄생배경에 대해 설명해 주세요.

- 클래스 단위로 네트워크를 분류하다보니, 어떤 기업에서는 적은 양의 호스트 주소가 필요한데, B Class 네트워크를 할당받아서 IP주소에 여유가 생기게 되고, 어떤 기업에서는 많은 양의 호스트 주소가 필요한데, C Class 네트워크를 할당받아서 IP주소가 부족해지는 현상이 생기게 된다.
- 따라서 클래스로만 네트워크를 분류하는 것은 비효율적이라는 결론이 나오고, 좀 더 **적절한 단위로 네트워크를 분할함으로써 낭비되는 IP주소 자원을 최소화하기 위해** 서브넷의 개념이 탄생하게 된다.
- 또한 브로드캐스팅을 사용할 때 연결된 호스트 디바이스가 많다면, 당연히 성능의 저하가 올 수 있다. 따라서 **네트워크의 규모를 줄여서 브로드 캐스팅으로 인한 부하를 줄일 수 있는 것**이다.

### 서브넷에 대해 설명해 주세요.

- 클래스 단위로 분류를 하게 되면 적절한 네트워크의 크기로 구분할 수 없다. 따라서 서브넷으로 분할하여 사용한다.
- 서브넷(Subnet)이라는 것은 하나의 네트워크가 분할되어 나눠진 작은 네트워크이다. 네트워크를 분할하는 것을 서브네팅(Subnetting)이라고 한다.
- 그리고 이 서브네팅은 서브넷 마스크(Subnet Mask)를 통하여 수행될 수 있다.
- (추가질문) 서브넷 마스크에 대해 설명해 주세요.
    - 서브넷 IP 주소에서 네트워크 주소와 호스트 주소를 구분하기 위한 구분자이다.
    - 네트워크 주소는 1, 호스트 주소는 0으로 표시한다.

### CIDR에 대해 설명해 주세요.

Classless Inter-Domain Routing

- 각 네트워크 대역을 구분 짓고 Inter-Domain 과 같이 구분된 네트워크간 통신을 위한 주소 체계
- CIDR을 통해 IP주소를 효율적으로 하당하고 라우팅 정보를 더 간결하게 표기할 수 있다.

### ref

- https://jake-seo-dev.tistory.com/225
- https://shlee0882.tistory.com/110
- https://bannavi.tistory.com/143
- 케이블 : https://m.blog.naver.com/sanwasupply/221356949786
- 허브, 스위치 : https://m.blog.naver.com/doctor-kick/221963899838
- 데이터링크 : [https://velog.io/@redgem92/네트워크-데이터-링크-계층Data-Link-Layer-1](https://velog.io/@redgem92/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%A7%81%ED%81%AC-%EA%B3%84%EC%B8%B5Data-Link-Layer-1)
- 이더넷 : https://security-nanglam.tistory.com/192
- CSMA/CD : https://security-nanglam.tistory.com/193
- TCP/IP 4계층 : [https://velog.io/@dyunge_100/Network-TCPIP-4계층에-대하여](https://velog.io/@dyunge_100/Network-TCPIP-4%EA%B3%84%EC%B8%B5%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC)
- 데이터의 네트워크 전송 과정 : [https://medium.com/@su_bak/네트워크에서-데이터가-전송되는-과정과-osi-7계층-7c0e90d859da](https://medium.com/@su_bak/%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%E1%84%8B%E1%85%A6%E1%84%89%E1%85%A5-%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%80%E1%85%A1-%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%89%E1%85%A9%E1%86%BC%E1%84%83%E1%85%AC%E1%84%82%E1%85%B3%E1%86%AB-%E1%84%80%E1%85%AA%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%80%E1%85%AA-osi-7%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC-7c0e90d859da)
- 클래스 : https://limkydev.tistory.com/168
- 서브넷 : https://hyoje420.tistory.com/32